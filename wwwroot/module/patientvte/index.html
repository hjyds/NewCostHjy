
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>医疗评估系统</title>



    <script src="/lib/jquery/dist/jquery.min.js"></script>

    <!--@*bootstrap 4开始table及select依赖js*@-->
    <script src="/lib/assets/js/popper_2.0.0.js"></script>

    <!--@*bootstrap框架*@-->
    <script src="/lib/Bootstrap_4.1.1/dist/js/bootstrap.js"></script>
    <link href="/lib/Bootstrap_4.1.1/dist/css/bootstrap.css" rel="stylesheet" />

    <!--@*bootstrap框架*@-->
    <script src="/lib/Bootstrap_4.1.1/dist/js/bootstrap.js"></script>
    <link href="/lib/Bootstrap_4.1.1/dist/css/bootstrap.css" rel="stylesheet" />

    <!--@*bootstrap表格插件*@-->
    <script src="/lib/bootstrap-table-1.15.3/bootstrap-table.js"></script>
    <script src="/lib/bootstrap-table-1.15.3/bootstrap-table-zh-CN.min.js"></script>
    <link href="/lib/bootstrap-table-1.15.3/bootstrap-table.min.css" rel="stylesheet" />

    <!--表格相关-->
    <link rel="stylesheet" href="/lib/bootstrap-table-1.20.2/bootstrap-table.min.css" />
    <link rel="stylesheet" href="/lib/bootstrap-select-1.13.18/css/bootstrap-select.min.css" />
    <script src="/lib/bootstrap-table-1.20.2/bootstrap-table.js"></script>
    <script src="/lib/bootstrap-table-1.20.2/locale/bootstrap-table-zh-CN.min.js"></script>
    <script src="/lib/bootstrap-select-1.13.18/js/bootstrap-select.js"></script>
    <script src="/lib/bootstrap-select-1.13.18/js/i18n/defaults-zh_CN.js"></script>


    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="/js/site.js" asp-append-version="true"></script>
    <script src="/js/zlWebApi.js" asp-append-version="true"></script>
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        /*      .card-hover {
            transition: all 0.3s ease;
        }

            .card-hover:hover {
                transform: translateY(-5px);
                box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            }*/

        .btn-transition {
            transition: all 0.3s ease;
        }

            .btn-transition:hover {
                transform: scale(1.05);
            }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- 头部导航 -->
    <header class="gradient-bg text-white shadow-lg">
        <div class="container mx-auto px-4 py-6">
            <div class="flex justify-between items-center">
                <div class="flex items-center space-x-3">
                    <i class="fas fa-stethoscope text-2xl"></i>
                    <h1 class="text-2xl font-bold">医疗评估系统</h1>
                </div>
                <nav class="hidden md:flex space-x-6">
                    <a href="#" class="hover:text-blue-200 transition">首页</a>
                    <a href="#" class="hover:text-blue-200 transition">患者管理</a>
                    <a href="#" class="hover:text-blue-200 transition">评估记录</a>
                    <a href="#" class="hover:text-blue-200 transition">系统设置</a>
                </nav>
                <button class="md:hidden text-xl">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- 主功能区域 -->
    <main class="container mx-auto px-4 py-8">
        <div class="max-w-4xl mx-auto">
            <!-- 表单区域 -->
            <div class="bg-white rounded-xl shadow-md overflow-hidden card-hover">
                <div class="gradient-bg px-6 py-4">
                    <h2 class="text-xl font-semibold text-white flex items-center">
                        <i class="fas fa-edit mr-2"></i>
                        评估信息录入
                    </h2>
                </div>

                <form id="assessmentForm" class="p-6 space-y-6">
                    <!-- 数据库输入 -->
                    <div>
                        <label for="database" class="block text-sm font-medium text-gray-700 mb-2 flex items-center">
                            <i class="fas fa-database text-gray-500 mr-2"></i>
                            数据库
                        </label>
                        <input type="text" id="database" name="database"
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"
                               placeholder="请输入数据库名称">
                    </div>

                    <!-- 医嘱ID输入 -->
                    <div>
                        <label for="orderId" class="block text-sm font-medium text-gray-700 mb-2 flex items-center">
                            <i class="fas fa-file-medical text-gray-500 mr-2"></i>
                            医嘱ID
                        </label>
                        <input type="text" id="orderId" name="orderId"
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"
                               placeholder="请输入医嘱ID" value="2874173">
                    </div>

                    <!-- VTE系统输入 -->
                    <div>
                        <label for="vteSystem" class="block text-sm font-medium text-gray-700 mb-2 flex items-center">
                            <i class="fas fa-lungs text-gray-500 mr-2"></i>
                            VTE系统
                        </label>
                        <input type="text" id="vteSystem" name="vteSystem"
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"
                               placeholder="请输入VTE系统信息" value="http://192.168.33.6:8400">
                    </div>

                    <!-- 病历系统输入 -->
                    <div>
                        <label for="medicalRecord" class="block text-sm font-medium text-gray-700 mb-2 flex items-center">
                            <i class="fas fa-clipboard-list text-gray-500 mr-2"></i>
                            病历系统
                        </label>
                        <input type="text" id="medicalRecord" name="medicalRecord"
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"
                               placeholder="请输入病历系统信息">
                    </div>

                    <!-- 按钮区域 -->
                    <div class="flex flex-col sm:flex-row gap-4 pt-4">
                        <button type="button" id="nurseAssessment"
                                class="flex-1 bg-green-500 hover:bg-green-600 text-white py-3 px-6 rounded-lg font-semibold btn-transition flex items-center justify-center">
                            <i class="fas fa-user-nurse mr-2"></i>
                            护士评估
                        </button>
                        <button type="button" id="nurseAssessmentDel"
                                class="flex-1 bg-green-500 hover:bg-green-600 text-white py-3 px-6 rounded-lg font-semibold btn-transition flex items-center justify-center">
                            <i class="fas fa-user-nurse mr-2"></i>
                            护士撤消
                        </button>
                        <button type="button" id="doctorAssessment"
                                class="flex-1 bg-blue-500 hover:bg-blue-600 text-white py-3 px-6 rounded-lg font-semibold btn-transition flex items-center justify-center">
                            <i class="fas fa-user-md mr-2"></i>
                            医生评估
                        </button>
                        <button type="button" id="doctorAssessmentDel"
                                class="flex-1 bg-blue-500 hover:bg-blue-600 text-white py-3 px-6 rounded-lg font-semibold btn-transition flex items-center justify-center">
                            <i class="fas fa-user-md mr-2"></i>
                            医生撤消
                        </button>
                    </div>
                </form>
            </div>

            <!-- 状态显示区域 -->
            <div id="statusMessage" class="mt-6 hidden">
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                    <div class="flex items-center">
                        <i class="fas fa-info-circle text-blue-500 mr-2"></i>
                        <span id="messageText" class="text-blue-700"></span>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        // 显示状态消息
        function showMessage(message, type = 'info') {
            const statusDiv = document.getElementById('statusMessage');
            const messageText = document.getElementById('messageText');

            statusDiv.className = `mt-6 ${type === 'error' ? 'bg-red-50 border-red-200' : 'bg-blue-50 border-blue-200'} rounded-lg p-4`;
            messageText.className = type === 'error' ? 'text-red-700' : 'text-blue-700';
            messageText.innerHTML = `<i class="fas ${type === 'error' ? 'fa-exclamation-triangle' : 'fa-info-circle'} mr-2"></i>${message}`;
            statusDiv.classList.remove('hidden');

            // 5秒后自动隐藏
            setTimeout(() => {
                statusDiv.classList.add('hidden');
            }, 5000);
        }

        // 获取表单数据
        function getFormData() {
            return {
                database: document.getElementById('database').value,
                orderId: document.getElementById('orderId').value,
                vteSystem: document.getElementById('vteSystem').value,
                medicalRecord: document.getElementById('medicalRecord').value,
                timestamp: new Date().toISOString()
            };
        }

        // 验证表单数据
        function validateForm(data) {
            return true;
            if (!data.database.trim()) {
                showMessage('请输入数据库名称', 'error');
                return false;
            }
            if (!data.orderId.trim()) {
                showMessage('请输入医嘱ID', 'error');
                return false;
            }
            return true;
        }

        // 处理评估提交  type=1表示撤消
        function handleAssessment(buttonType, type = 0)
        {
            const formData = getFormData();

            if (!validateForm(formData)) {
                return;
            }

            // 添加按钮标志
            formData.buttonType = buttonType;
            formData.Cancel = type;              

            // 控制台输出（模拟后端传输）
            console.log('提交的评估数据:', formData);

            let ret = zlPost(`/ZlVteInterface/TestVteEval`, JSON.stringify(formData));      
            if (1 == type) return;

            let objData = ret.Data;
            let url = "";
            if (objData?.Result == 1) {
                url = objData.Url;
                let page = window.open(url, "123123", 'width=' + (window.screen.availWidth) + ',height=' + (window.screen.availHeight) + ',top=0,left=0,toolbar=no,titlebar=no,menubar=0,scrollbars=yes, resizable=yes,location=0,status=0,depended =yes,maximize=true');
            }
        }

        // 事件监听
        document.getElementById('nurseAssessment').addEventListener('click', function () {
            handleAssessment('nurse');
        });

        document.getElementById('doctorAssessment').addEventListener('click', function () {
            handleAssessment('doctor');
        });

        document.getElementById('nurseAssessmentDel').addEventListener('click', function () {
            handleAssessment('nurse',1);
        });

        document.getElementById('doctorAssessmentDel').addEventListener('click', function () {
            handleAssessment('doctor',1);
        });

        // 键盘快捷键支持
        document.addEventListener('keydown', function (event) {
            if (event.ctrlKey || event.metaKey) {
                if (event.key === '1') {
                    event.preventDefault();
                    document.getElementById('nurseAssessment').click();
                } else if (event.key === '2') {
                    event.preventDefault();
                    document.getElementById('doctorAssessment').click();
                }
            }
        });
         
    </script>
</body>
</html>